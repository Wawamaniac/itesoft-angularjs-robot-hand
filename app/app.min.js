/*!
 * Copyright 2015 itesoft.
 * http://itesoft.com/
 *
 * showcase-quickstart, v0.0.1
 * A powerful music manager.*/
!function(){function a(a,e,t){this.rotation=t;var n=this,i=a;e.editable&&i.addEventListener("mousewheel",function(a,t){var o=i.getElementsByClassName("rotation")[0];a.deltaY<0&&n.rotation<=170&&(n.rotation+=10),a.deltaY>0&&n.rotation>=10&&(n.rotation-=10);var l=100*n.rotation/180;o.style.height=l+"%",e.handModel.thumb=e.thumb.rotation,e.handModel.index=e.index.rotation,e.handModel.major=e.major.rotation,e.handModel.ringfinger=e.ringfinger.rotation,e.handModel.auricular=e.auricular.rotation,e.$apply(),a.preventDefault()},!1)}angular.module("robot.manager",["itesoft","ngRoute","ngSanitize","pascalprecht.translate","ui.bootstrap.dropdown","localStorage.service","ui.hand","ui.sortable"]).config(["$translateProvider","$translatePartialLoaderProvider","ITLocalStorageProvider",function(a,e,t){a.registerAvailableLanguageKeys(["en","fr","de"],{en_US:"en",en_GB:"en",fr_FR:"fr","fr-CA":"fr","de-DE":"de"}).determinePreferredLanguage(),a.useLoader("$translatePartialLoader",{urlTemplate:"assets/locale/{lang}/{part}-{lang}.json"}),a.useSanitizeValueStrategy(),t.defaultKey="robot_api_config"}]).run(["$rootScope","$route",function(a,e){a.$on("$routeChangeSuccess",function(){a.pageTitle=e.current.title})}]),angular.module("robot.manager").config(["$routeProvider",function(a){a.when("/api/config",{templateUrl:"app/features/api/config/configView.html",controller:"ApiConfigController",title:"API Configuration"}).when("/robot/hand",{templateUrl:"app/features/robot/hand/handView.html",controller:"HandController",title:"Hand Controller"}).otherwise({redirectTo:"/api/config"})}]),angular.module("ui.hand",[]).directive("robotHand",[function(){return{restrict:"EA",scope:{editable:"=",handModel:"=",scale:"="},template:'<div  style="height: {{500 * scale}}px;" class="hand"> <div style="height: {{210 * scale}}px; margin-top: {{300 * scale}}px; width: {{180 * scale}}px; border-radius: {{20 * scale}}px;" class="pome"></div> <div style="margin-top:{{90* scale}}px; height : {{210* scale}}px; margin-left:{{5 * scale}}px; margin-right: {{ 5 * scale}}px; border-radius :{{20 * scale}}px; width : {{35 * scale}}px;" class="finger auricular"> <p style="font-size: {{15 *scale}}px; padding-top: {{50 * scale}}px; width: {{35 * scale}}px;" class="info">{{auricular.rotation}}</p> <div id="rotation" class="rotation" style="height: {{(auricular.rotation * 100) / 180}}%"></div> </div> <div style="margin-top:{{40* scale}}px; height : {{260* scale}}px; margin-left:{{5 * scale}}px; margin-right: {{ 5 * scale}}px; border-radius :{{20 * scale}}px; width : {{35 * scale}}px;"  class="finger ringfinger"> <p style="font-size: {{15 *scale}}px;padding-top: {{50 * scale}}px; width: {{35 * scale}}px;" class="info">{{ringfinger.rotation}}</p> <div id="ringfingerRotate" class="rotation" style="height: {{(ringfinger.rotation * 100) / 180}}%"></div> </div> <div style="margin-top:{{0* scale}}px; height : {{300* scale}}px; margin-left:{{5 * scale}}px; margin-right: {{ 5 * scale}}px; border-radius :{{20 * scale}}px; width : {{35 * scale}}px;" class="finger major "> <p  style="font-size: {{15 *scale}}px;padding-top: {{50 * scale}}px; width: {{35 * scale}}px;" class="info">{{major.rotation}}</p> <div id="majorfingerRotate" class="rotation" style="height: {{(major.rotation * 100) / 180}}%"></div> </div> <div style="margin-top:{{20* scale}}px; height : {{280* scale}}px; margin-left:{{5 * scale}}px; margin-right: {{ 5 * scale}}px; border-radius :{{20 * scale}}px; width : {{35 * scale}}px;"  class="finger index"> <p style="font-size: {{15 *scale}}px;padding-top: {{50 * scale}}px; width: {{35 * scale}}px;" class="info">{{index.rotation}}</p> <div id="indexfingerRotate" class="rotation" style="height: {{(index.rotation * 100) / 180}}%"></div> </div> <div style="margin-top:{{250 * scale}}px; height : {{150* scale}}px;margin-left:{{5 * scale}}px; margin-right: {{ 5 * scale}}px; border-radius :{{20 * scale}}px; width : {{35 * scale}}px;"  class="finger thumb"> <p style="font-size: {{15 *scale}}px;padding-top: {{50 * scale}}px; width: {{35 * scale}}px;" class="info">{{thumb.rotation}}</p> <div id="thumbRotate" class="rotation" style="height: {{(thumb.rotation * 100) / 180}}%"></div> </div> </div>',compile:function(e,t){return{pre:function(e,t,n,i,o){e.$watch("handModel",function(){e.major=new a(t[0].getElementsByClassName("major")[0],e,e.handModel.major),e.index=new a(t[0].getElementsByClassName("index")[0],e,e.handModel.index),e.auricular=new a(t[0].getElementsByClassName("auricular")[0],e,e.handModel.auricular),e.thumb=new a(t[0].getElementsByClassName("thumb")[0],e,e.handModel.thumb),e.ringfinger=new a(t[0].getElementsByClassName("ringfinger")[0],e,e.handModel.ringfinger)},!0)},post:function(a,e,t,n,i){}}},controller:["$scope",function(a){a.handID=a.$id}]}}]),angular.module("robot.manager").factory("Application",[function(){function a(){this.API={URL:""},this.stepTime=500,this.playlist=[],this.savedPlaylists=[]}return console.log("Application"),function(){return new a}}]),angular.module("robot.manager").service("ApplicationService",["ITLocalStorage","Application",function(a,e){function t(){var t=a.load();return t?t:new e}return console.log("ApplicationService"),{load:t,save:a.save}}]),angular.module("localStorage.service",[]),angular.module("localStorage.service").provider("ITLocalStorage",function(){console.log("ITLocalStorage");var a=this;a.defaultKey="IT_KEY",this.$get=function(){function e(e){e&&localStorage.setItem(a.defaultKey,e)}function t(){return localStorage.getItem(a.defaultKey)}return{save:e,load:t}}}),angular.module("robot.manager").service("RobotPlayerService",["$http",function(a){function e(e,t){console.log("RobotPlayerService _play baseUrl : "+e),console.log("RobotPlayerService _play step : "),console.log(t),a({method:"GET",url:e,params:t.hand}).then(function(a){console.log("RobotPlayerService _play successCallback : "+a)},function(a){console.log("RobotPlayerService _play errorCallback : "+a)})}return console.log("RobotPlayerService"),{play:e}}]),angular.module("robot.manager").service("TranslationService",["$q","$translate","$translatePartialLoader",function(a,e,t){return function(){return t.addPart("global"),angular.forEach(arguments,function(a){t.addPart(a)}),e.refresh()}}]),angular.module("robot.manager").factory("Hand",[function(){function a(a){a?(this.thumb=a.thumb,this.index=a.index,this.major=a.major,this.ringfinger=a.ringfinger,this.auricular=a.auricular):(this.thumb=180,this.index=180,this.major=180,this.ringfinger=180,this.auricular=180)}return function(e){return new a(e)}}]),angular.module("robot.manager").controller("HandController",["$scope","ApplicationService","RobotPlayerService","Hand","Step",function(a,e,t,n,i){console.log("HandController"),a.ApplicationService=e,a.RobotPlayerService=t,a.application=angular.fromJson(a.ApplicationService.load()),a.hand=new n,a.addHandConfigToPlaylist=function(){console.log("addHandConfigToPlaylist"),console.log(a.hand),a.application.playlist.push(new i(a.application.playlist.length,new n(a.hand)))},a.deleteStep=function(e){var t=-1;angular.forEach(a.application.playlist,function(a,n){angular.equals(a,e)&&(t=n)}),-1!=t&&(a.application.playlist.splice(t,1),angular.forEach(a.application.playlist,function(a,e){a.index=e}))},a.savePlaylist=function(e){var t=prompt("Name for the playlist","Hand(some)");if(null!=t){var n=!1;angular.forEach(a.application.savedPlaylists,function(a,e){a.name===t&&(n=!0)}),n?(alert("Playlist already exists, please choose another name."),a.savePlaylist()):(a.application.savedPlaylists.push({name:t,playlist:e}),a.application.playlist=[])}},a.deletePlaylist=function(e){var t=confirm("Are you really sure you want to delete the playlist "+e.name+" ?");if(t===!0){var n=-1;angular.forEach(a.application.savedPlaylists,function(a,t){a.name===e.name&&(n=t)}),-1!=n&&a.application.savedPlaylists.splice(n,1)}},a.selectPlaylist=function(e){var t=confirm("Unsaved changes on current playlist will be lost. Do you want to load the playlist "+e.name+" ?");t===!0&&(a.application.playlist=e.playlist)},a.openHand=function(){a.hand.thumb=0,a.hand.index=0,a.hand.major=0,a.hand.ringfinger=0,a.hand.auricular=0},a.closeHand=function(){a.hand.thumb=180,a.hand.index=180,a.hand.major=180,a.hand.ringfinger=180,a.hand.auricular=180},a.$watch("hand",function(e,t){a.RobotPlayerService.play(a.application.API.URL,{hand:a.hand})},!0),a.$watch("application",function(e,t){a.ApplicationService.save(angular.toJson(a.application))},!0),a.playPlaylist=function(){angular.forEach(a.application.playlist,function(e,t){setTimeout(function(){a.RobotPlayerService.play(a.application.API.URL,e)},t*a.application.stepTime)})}}]),angular.module("robot.manager").factory("Step",[function(){function a(a,e){this.index=a,this.hand=e}return function(e,t){return new a(e,t)}}]),angular.module("robot.manager").controller("ApiConfigController",["$scope","$timeout","ApplicationService",function(a,e,t){console.log("ApiConfigController"),a.ApplicationService=t,a.application=angular.fromJson(a.ApplicationService.load()),a.apiInput=a.application.API.URL,a.saveApiConfig=function(){var e=a.apiInput;null===e||void 0===e||""===e||(a.application.API.URL=e,a.ApplicationService.save(angular.toJson(a.application)))}}])}();